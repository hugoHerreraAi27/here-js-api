
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.57.0/HERE_NOTICE
 */

H.util.eval("zg.prototype.ze=da(2,function(a,b){this.root.ze(a,jb(b)?b:this.Ph)});Dg.prototype.ze=da(1,function(a,b){var c=0,d;if(!a(this)&&b--)for(;3>=c;c++)(d=this[c])&&d.ze(a,b)});function $r(a){hc.call(this);this.fc=[];var b;a?Pa(b={},as,a):b=as;this.options=b;hc.call(this)}u($r,hc);var bs={clusters:[],noisePoints:[]},as={projection:ld,min:0,max:22,eps:32,minWeight:2};m=$r.prototype;m.ue=function(a){this.fc=a;this.od=!0};m.xc=function(a){this.fc.push(a);this.od=!0};m.Al=function(a){this.fc=this.fc.concat(a);this.od=!0};m.Dk=function(a){this.fc=this.fc.filter(function(b){return b!==a});this.od=!0};m.disposeInternal=function(){$r.g.disposeInternal.call(this);delete this.fc};\n$r.prototype.disposeInternal=$r.prototype.disposeInternal;$r.prototype.Ow=ze;function cs(a,b,c,d,e,f){this.Co=b;a&&(this.parent=a,b&1?(c=a[8],e=a[5]):(c=a[7],e=a[8]),b&2?(d=a[9],f=a[6]):(d=a[4],f=a[9]));this[7]=c;this[5]=e;this[8]=(c+e)/2;this[4]=d;this[6]=f;this[9]=(d+f)/2}m=cs.prototype;m.hb=0;m.th=function(a){return this[a]||(++this.hb,this[a]=new cs(this,a))};m.removeChild=function(a){var b=a.Co;this[b]===a&&(delete this[b],delete a.parent,--this.hb)};m.ze=function(a,b){for(var c=0,d=this;d=d.parent;)++c;ds(this,a,b,c)};\nfunction ds(a,b,c,d){var e,f;if(!b(a,d)&&c--)for(++d,e=0;4>e;e++)(f=a[e])&&ds(f,b,c,d)}m.Qg=function(a){(this.entries||(this.entries=[])).push(a)};m.dj=0;m.ej=0;m.Ec=0;function es(a){this.Ph=a||10;this.Ck=this.Bk=this.Zi=this.Yi=2147483648;this.Em()}m=es.prototype;m.Em=function(){this.head=this.root=new cs(null,NaN,this.Yi-this.Bk,this.Zi-this.Ck,this.Yi+this.Bk,this.Zi+this.Ck)};m.Ll=function(){fs(this,this.root);this.Em()};function fs(a,b){var c,d;for(c=0;4>c;c++)if(d=b[c])fs(a,d),delete b[c];delete b.parent;delete b.entries}\nm.jd=function(a){var b=this.head,c;if(a){var d=a;if(d!==b)for(b=d;d=d.parent;)if(d.entries||1<d.hb)b=d}else for(;!b.entries&&2>(c=b.hb);)if(c)b=d;else break;this.head=b};m.Yd=function(a,b,c,d){var e=this.root;if(!(a>=e[7]&&b>=e[4]&&a<=e[5]&&b<=e[6]))throw Error(\"Coordinates out of bounds\");return this.Vb(this.root,a,b,c,this.Ph,d)};\nm.Vb=function(a,b,c,d,e,f){var g=a.entries;e?a.hb?g=this.Sj(a,b,c,d,e,f):g?(g=g[0],g=a.th(+(g[1]>=a[8])|+(g[0]>=a[9])<<1),g.entries=a.entries,g.dj=a.dj,g.ej=a.ej,g.Ec=a.Ec,g.dh=a.dh,g.cj=a.cj,g.aj=a.aj,g.bj=a.bj,delete a.entries,this.jd(g),g=this.Sj(a,b,c,d,e,f)):(a.Qg(g=new gs(b,c,d,f)),this.jd(a)):(g||this.jd(a),a.Qg(g=new gs(b,c,d,f)));a.dj+=b*d;a.ej+=c*d;a.Ec+=d;a.dh===B?(a.dh=a.aj=b,a.cj=a.bj=c):(b<a.dh?a.dh=b:b>a.aj&&(a.aj=b),c<a.cj?a.cj=c:c>a.bj&&(a.bj=c));return g};\nm.Sj=function(a,b,c,d,e,f){return this.Vb(a.th(+(b>=a[8])|+(c>=a[9])<<1),b,c,d,e-1,f)};m.ze=function(a,b){ds(this.root,a,b===+b?b:this.Ph,0)};function gs(a,b,c,d){this[0]=b;this[1]=a;this.weight=c;this.data=d};function hs(a,b,c){this.pa=a;this.dm=b;this.de=c}t(\"H.clustering.fastgrid.NoisePoint\",hs);hs.prototype.xa=function(){this.Sc||(this.Sc=this.pa.Za(this.dm[1],this.dm[0],1));return this.Sc};hs.prototype.getPosition=hs.prototype.xa;hs.prototype.Wd=function(){return this.dm.weight};hs.prototype.getWeight=hs.prototype.Wd;hs.prototype.Yf=ye;hs.prototype.isCluster=hs.prototype.Yf;hs.prototype.Sd=function(){return this.de-this.pa.hh};hs.prototype.getMinZoom=hs.prototype.Sd;hs.prototype.getData=function(){return this.dm.data};\nhs.prototype.getData=hs.prototype.getData;function is(a,b,c,d){this.pa=a;this.tc=b;this.de=c;this.Jq=d;this.wp=Ia(this.wp,this);this.up=Ia(this.up,this)}t(\"H.clustering.fastgrid.Cluster\",is);is.prototype.xa=function(){this.Sc||(this.Sc=this.pa.Za(this.tc.dj,this.tc.ej,this.tc.Ec));return this.Sc};is.prototype.getPosition=is.prototype.xa;is.prototype.Wd=function(){return this.tc.Ec};is.prototype.getWeight=is.prototype.Wd;is.prototype.Yf=xe;is.prototype.isCluster=is.prototype.Yf;\nis.prototype.Sd=function(){return this.de?this.de-this.pa.hh:-1/0};is.prototype.getMinZoom=is.prototype.Sd;is.prototype.om=function(){return this.Jq-this.pa.hh};is.prototype.getMaxZoom=is.prototype.om;is.prototype.C=function(){this.I||(this.I=Zf(this.pa.Za(this.tc.dh,this.tc.cj,1),this.pa.Za(this.tc.aj,this.tc.bj,1),!0));return this.I};is.prototype.getBoundingBox=is.prototype.C;is.prototype.vp=function(a){this.$t=a;this.tc.ze(this.wp,Wb)};is.prototype.forEachEntry=is.prototype.vp;\nis.prototype.wp=function(a,b){var c=!1,d,e;a.Ec>=this.pa.Av&&a!==this.tc&&a.Ec!==this.tc.Ec&&(this.$t(new is(this.pa,a,0,b)),c=!0);if(!c&&(d=a.entries))for(a=d.length,e=0;e<a;e++)this.$t(new hs(this.pa,d[e],b));return c};is.prototype.zj=function(a){this.hz=a;this.tc.ze(this.up,Wb)};is.prototype.forEachDataPoint=is.prototype.zj;is.prototype.up=function(a,b){var c;if(a=a.entries){var d=a.length;for(c=0;c<d;c++)this.hz(new hs(this.pa,a[c],b))}return!1};function js(a){$r.call(this,a);a=this.options;this.le=a.projection;this.hk=a.min;this.eg=a.max;this.Av=a.minWeight;this.hh=7-Ab(Eb(zb(1,a.eps))/Ob);this.vr=new es(zb(this.hk,this.eg+this.hh))}u(js,$r);m=js.prototype;m.ue=function(a){var b=0,c=a.length,d,e=new F(0,0),f=this.le,g=this.vr;js.g.ue.call(this,a);for(g.Ll();b<c;b++)f.Re(d=a[b],e).scale(4294967296).floor(),g.Yd(e.x,e.y,d.wt,d.data);this.od=!0};m.xc=function(a){js.g.xc.call(this,a);this.ue(this.fc)};\nm.Al=function(a){for(var b=a.length,c=js.g.xc;b--;)c.call(this,a[b]);this.ue(this.fc)};m.Dk=function(a){js.g.Dk.call(this,a);this.ue(this.fc)};m.Za=function(a,b,c,d){return this.le.Za(a/c/4294967296,b/c/4294967296,d)};m.es=function(a){if(this.od){var b={clusters:[],noisePoints:[]};ks(this,this.vr.root,0,this.eg+this.hh,-1/0,b,null);this.od=!1;a(b)}};\nfunction ks(a,b,c,d,e,f,g){var h=b.Ec,k;g&&(g.node.Ec!==h?(f.clusters.push(new is(a,g.node,g.depth,c-1)),g=null):e++);g||(h>=a.Av?(g={node:b,depth:c},e=c):ls(a,b,e+1,f));if(b.hb&&d--)for(c++,h=0;4>h;h++)if(k=b[h])ks(a,k,c,d,e,f,g),g=null;g&&f.clusters.push(new is(a,g.node,g.depth,a.eg+a.hh))}function ls(a,b,c,d){b=b.entries;var e;if(b){var f=b.length;d=d.noisePoints;for(e=0;e<f;e++)d.push(new hs(a,b[e],c))}else for(e=0;4>e;e++)(f=a[e])&&ls(a,f,c,d)}\nm.disposeInternal=function(){js.g.disposeInternal.call(this);this.vr=null};js.prototype.disposeInternal=js.prototype.disposeInternal;function ms(a,b){this.ir=a;this.de=b}t(\"H.clustering.grid.NoisePoint\",ms);ms.prototype.xa=function(){return hd(this.ir)};ms.prototype.getPosition=ms.prototype.xa;ms.prototype.Wd=function(){return this.ir.wt};ms.prototype.getWeight=ms.prototype.Wd;ms.prototype.Yf=ye;ms.prototype.isCluster=ms.prototype.Yf;ms.prototype.Sd=function(){return this.de};ms.prototype.getMinZoom=ms.prototype.Sd;ms.prototype.getData=function(){return this.ir.data};ms.prototype.getData=ms.prototype.getData;function ns(a,b,c){this.Jq=this.de=c;this.jr=[];this.us=0;this.I=Zf(a,b,!0)}t(\"H.clustering.grid.Cluster\",ns);ns.prototype.Pi=function(a){this.Sc||(this.Sc=hd(a));this.us+=a.wt||1;this.jr.push(a)};ns.prototype.xa=function(){return this.Sc};ns.prototype.getPosition=ns.prototype.xa;ns.prototype.Wd=function(){return this.us};ns.prototype.getWeight=ns.prototype.Wd;ns.prototype.Yf=xe;ns.prototype.isCluster=ns.prototype.Yf;ns.prototype.Sd=function(){return this.de};ns.prototype.getMinZoom=ns.prototype.Sd;\nns.prototype.om=function(){return this.Jq};ns.prototype.getMaxZoom=ns.prototype.om;ns.prototype.C=function(){return this.I};ns.prototype.getBoundingBox=ns.prototype.C;ns.prototype.vp=function(a){this.zj(a)};ns.prototype.forEachEntry=ns.prototype.vp;ns.prototype.zj=function(a){var b=this;if(!Za(a))throw new D(this.zj,0,a);this.jr.forEach(function(c){a(new ms(c,b.de+1))})};ns.prototype.forEachDataPoint=ns.prototype.zj;function os(a){$r.call(this,a)}u(os,$r);\nos.prototype.es=function(a){var b=this.options,c=b.min,d=b.max,e=[],f=[],g;if(this.od){for(g=this.fc;c<=d;c++){for(var h,k=void 0,l,n,p,q,r,v,w,y=c,G=g,I=e,P=f,W=b.eps,Ua=b.projection,ba=b.minWeight,ub=G.length,Ca=Math.pow(2,y+8),Qa=[];w=G[--ub];)if(!w.Bs){n=Ua.Re(w).scale(Ca).floor();v=Ca;r=n.x;q=n.y;for(l=Qa.length;l--;)h=Qa[l],p=h.xa(),h.zs||(h.zs=Ua.Re(p).scale(Ca).floor()),p=h.zs,p=p.kb(n),p<v&&(v=p,k=h);k&&k.C().Ff(w)||(k=new ns(Ua.wn({x:(r-W)/Ca,y:(q-W)/Ca}),Ua.wn({x:(r+W)/Ca,y:(q+W)/Ca}),\ny),Qa.push(k));k.Pi(w);k=null}for(ub=Qa.length;ub--;)if(h=Qa[ub],l=h.Wd(),l<ba)for(h=h.jr,l=h.length;w=h[--l];)P.push(new ms(w,y)),w.Bs=!0;else I.push(h)}c=0;for(d=g.length;c<d;c++)delete g[c].Bs;this.od=!1;a({clusters:e,noisePoints:f})}};function ps(a){this.na=a;this.py=11;a=document.createElement(\"canvas\");var b=a.getContext(\"2d\"),c=this.na,d=14*c;a.width=d;a.height=d;b.scale(c,c);b.beginPath();b.strokeStyle=\"#FFFFFF\";b.fillStyle=\"#1080DD\";b.arc(7,7,6,0,2*Math.PI,!1);b.fill();b.lineWidth=1;b.stroke();this.LB=new um(a,{size:{w:14,h:14},anchor:{x:7,y:7}});this.ot={};this.pt={}}t(\"H.clustering.theme.Circular\",ps);\nfunction qs(a,b,c){var d,e=document.createElement(\"canvas\"),f=e.getContext(\"2d\");var g=a.na;var h=b*g;e.width=h;e.height=h;f.scale(g,g);g=b+\":\"+c;(d=a.ot[g])?f.putImageData(d,0,0):(b/=2,f.beginPath(),f.strokeStyle=\"rgba(\"+c+\",0.2)\",f.fillStyle=\"rgba(\"+c+\",1)\",f.arc(b,b,b/5*3,0,2*Math.PI,!1),f.fill(),f.lineWidth=b/5*4,f.stroke(),a.ot[g]=f.getImageData(0,0,h,h));return e}\nps.prototype.xz=function(a){var b=a.Wd();var c=this.pt[b];if(!c){if(10>b){c=qs(this,28,\"118,209,0\");var d={x:11,y:18}}else 25>b?(c=qs(this,38,\"255,105,0\"),d={x:13,y:23}):50>b?(c=qs(this,38,\"240,60,0\"),d={x:13,y:23}):100>b?(c=qs(this,38,\"181,0,21\"),d={x:13,y:23}):1E3>b?(c=qs(this,48,\"181,0,21\"),d={x:15,y:28}):(c=qs(this,66,\"181,0,21\"),d={x:20,y:38});var e=c.getContext(\"2d\");e.fillStyle=\"#FFFFFF\";e.font=\"bold \"+this.py+\"px Arial\";e.fillText(String(b),d.x,d.y);d=c.width/this.na;c=new um(c,{size:{w:d,\nh:d},anchor:{x:d/2,y:d/2}});this.pt[b]=c}b=new $m(a.xa(),{icon:c,min:a.Sd(),max:a.om()});b.setData(a);return b};ps.prototype.getClusterPresentation=ps.prototype.xz;ps.prototype.iA=function(a){var b=new $m(a.xa(),{icon:this.LB,min:a.Sd()});b.setData(a);return b};ps.prototype.getNoisePresentation=ps.prototype.iA;function rs(a){$r.call(this,a);a=this.options;if(a.projection!==ld)throw new D(rs,0,\"Other projection than mercator not supported yet\");this.le=a.projection;this.lp=a.eps;this.GB=a.minWeight;this.dw=new md(this.le);(new Th).registerProcessor(\"cluster\",\"H.clustering.dynamicgrid.worker\");this.gg=A(this.gg,this);this.Pq=A(this.Pq,this)}u(rs,$r);rs.prototype.Ow=function(a,b){this.Jy=a;this.Ky=Bb(b)};\nrs.prototype.es=function(a,b){var c=this.Lg;var d=this.Jy,e=this.Ky||0;var f=!c||!(c.zoom===e&&c.Si.da(d));if(d&&(this.od||f)){c&&3>c.state&&c.cancel();this.od=!1;c=this.lp;if(c>=128*Gb(2,e))var g=ss;else{f=this.dw;f.Va(e);var h=f.Gb(d.Lc());g=f.Gb(d.Jc());h.y-=c;g.y+=c;h=f.sk(h);var k=f.sk(g);g=new J(h.lat,h.lng,k.lat,k.lng);c=f.Za(c,0).lng+180;g=g.ce(h.lat,h.lng-c,k.lat,h.lng).ce(h.lat,k.lng,k.lat,k.lng+c)}c=g;h=this.fc;g=[];for(f=h.length;f--;)c.Ff(h[f])&&g.push(h[f]);0<g.length?(this.Lg=new ts(d,\ne,g,this.lp,this.GB,this.le!==ld,a,b),this.Lg.then(this.gg,this.Pq)):a(bs)}};\nrs.prototype.gg=function(a){Ba(a)||(a=new x.Uint32Array(a));for(var b=this.Lg,c=b.dC,d=0,e=a[d++],f=Array(e),g=0,h=[],k=a.length,l=this.Lg.My,n=this.Lg.zoom;e--;)f[g++]=new ms(l[a[d++]],n);for(;d<k;){e=a[d++];g=l[a[d]];var p=this.dw;var q=this.lp;p.Va(this.Lg.zoom);var r=p.Gb(g);g=p.Za(r.x-q,r.y-q);p=p.Za(r.x+q,r.y+q);g=new J(g.lat,g.lng,p.lat,p.lng);for(g=new ns(g.Lc(),g.Jc(),n);e--;)g.Pi(l[a[d++]]);h.push(g)}c.call(b,{clusters:h,noisePoints:f})};rs.prototype.Pq=function(a){gb(a)&&this.Lg.UB(a)};\nvar ss=new J(90,-180,-90,180);rs.prototype.disposeInternal=function(){rs.g.disposeInternal.call(this)};rs.prototype.disposeInternal=rs.prototype.disposeInternal;function ts(a,b,c,d,e,f,g,h){this.Si=a;this.zoom=b;this.My=c;this.dC=g;this.UB=h;a=c.length;g=3*a;h=new (x.Float64Array||Array)(g);for(var k;a--;)k=c[a],h[--g]=k.lat,h[--g]=k.lng,h[--g]=k.wt;fe.call(this,\"cluster\",{message:[h,d,e,b,f]},void 0)}u(ts,Vh);t(\"H.clustering.DataPoint\",function(a,b,c,d){this.lat=a;this.lng=b;this.wt=c===+c?c:1;this.data=d});function us(a,b){b=b||{};var c={},d=b.min||0,e=zb(d,b.max||22);d={min:d,max:e};us.g.constructor.call(this,d);this.na=b.pixelRatio||le();Pa(c,as,d,b.clusteringOptions||{});c.minWeight=zb(as.minWeight,c.minWeight);switch(c.strategy){case vs.DYNAMICGRID:if(c.projection!==ld)throw new D(us,1,\"Unsupported projection\");this.pa=new rs(c);break;case vs.GRID:this.pa=new os(c);break;default:this.pa=new js(c)}this.pa.ue(a);this.fl=b.theme||new ps(this.na);this.No=A(this.No,this);this.gg=A(this.gg,this);ws(this)}\nu(us,Q);t(\"H.clustering.Provider\",us);us.prototype.disposeInternal=function(){us.g.disposeInternal.call(this);this.Ag.ia();this.pa.l();delete this.pa;delete this.Qm;delete this.fl;x.clearTimeout(this.hp)};var vs={FASTGRID:0,GRID:1,DYNAMICGRID:2};us.Strategy=vs;us.prototype.dy=150;us.prototype.No=function(){this.dispatchEvent(\"start\");this.pa.es(this.gg,ze)};function ws(a,b,c){a.hp&&x.clearTimeout(a.hp);b&&a.pa.Ow(b,c);a.hp=x.setTimeout(a.No,a.dy)}\nus.prototype.gg=function(a){this.Qm=a;xs(this);this.dispatchEvent(\"end\")};us.prototype.ue=function(a){this.pa.ue(a);ws(this)};us.prototype.setDataPoints=us.prototype.ue;us.prototype.xc=function(a){this.pa.xc(a);ws(this)};us.prototype.addDataPoint=us.prototype.xc;us.prototype.Al=function(a){this.pa.Al(a);ws(this)};us.prototype.addDataPoints=us.prototype.Al;us.prototype.Dk=function(a){this.pa.Dk(a);ws(this)};us.prototype.removeDataPoint=us.prototype.Dk;us.prototype.EA=function(){return this.fl};\nus.prototype.getTheme=us.prototype.EA;us.prototype.ZC=function(a){this.fl=a;this.Qm&&(this.Ag.ia(),xs(this))};us.prototype.setTheme=us.prototype.ZC;function xs(a){var b=a.Qm.clusters,c=a.Qm.noisePoints,d=b.length,e=c.length,f=0<d+e;for(a.Ag.ia();e--;){var g=c[e];a.Ag.Y(a.fl.getNoisePresentation(g))}for(;d--;)c=b[d],a.Ag.Y(a.fl.getClusterPresentation(c));f&&a.jb()}us.prototype.Tc=function(){return!0};us.prototype.providesDomMarkers=us.prototype.Tc;us.prototype.Uc=function(){return!0};\nus.prototype.providesMarkers=us.prototype.Uc;us.prototype.me=function(){return!0};us.prototype.providesSpatials=us.prototype.me;us.prototype.xk=function(a,b){ws(this,a,b)};us.prototype.preprocessData=us.prototype.xk;t(\"H.clustering.buildInfo\",function(){return Zm(\"H-clustering\",\"1.57.0\",\"161a2e3\",{region:\"row\"})});\n");